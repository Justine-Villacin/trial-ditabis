<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Login - LearnSync</title>
   <link rel="stylesheet" href="{{ url_for('static', filename='css/login.css') }}">
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
   <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:wght@600;700&display=swap" rel="stylesheet">
   </head>
<body>
   <a href="/" class="back-to-home">
      <i class="fas fa-arrow-left"></i>
      <span>Back to Home</span>
   </a>

   <div class="login-container">
      <h1>LearnSync</h1>
      <p class="subtitle">Welcome back! Please login to your account.</p>

      <div class="flash-messages">
         {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                  {% for category, message in messages %}
                     <div class="flash-message {{ category }}">
                        {{ message }}
                     </div>
                  {% endfor %}
            {% endif %}
         {% endwith %}
      </div>

      <div class="user-type-selection">
         <label>Select Account Type</label>
         <div class="radio-group">
            <input type="radio" id="student" name="userType" value="student" checked>
            <label for="student">
               <i class="fas fa-user-graduate"></i>
               Student
            </label>
            <input type="radio" id="professor" name="userType" value="professor">
            <label for="professor">
               <i class="fas fa-chalkboard-teacher"></i>
               Professor
            </label>
         </div>
      </div>

      <form method="POST" action="/login" id="loginForm">
         <input type="hidden" name="userType" id="userTypeInput" value="student">
         
         <div class="input-group">
            <i class="icon fas fa-envelope"></i>
            <input type="email" id="email" name="email" placeholder="Email address" required>
         </div>
         <div class="input-group">
            <i class="icon fas fa-lock"></i>
            <input type="password" id="password" name="password" placeholder="Password" required>
            <button type="button" 
                     onclick="togglePasswordVisibility('password', this)" 
                     class="password-toggle">
               <i class="fas fa-eye"></i>
            </button>
         </div>

         <div class="options">
            <label>
               <input type="checkbox" name="remember">
               Remember me
            </label>
            <a href="/forgot-password" id="forgotLink">Forgot Password?</a>
         </div>

         <button class="login-btn" type="submit">Log In</button>
         
         <div class="signup-redirect">
            Don't have an account? <a href="/signup">Sign Up</a>
         </div>
      </form>
   </div>

   <script>
      document.addEventListener('DOMContentLoaded', function() {
         const studentRadio = document.getElementById('student');
         const professorRadio = document.getElementById('professor');
         const userTypeInput = document.getElementById('userTypeInput');
         const loginForm = document.getElementById('loginForm');
         const loginBtn = loginForm.querySelector('.login-btn');

         function updateUserType() {
            userTypeInput.value = studentRadio.checked ? 'student' : 'professor';
         }

         studentRadio.addEventListener('change', updateUserType);
         professorRadio.addEventListener('change', updateUserType);

         // Optional: Add loading state on submit
         loginForm.addEventListener('submit', function() {
            loginBtn.classList.add('loading');
            loginBtn.textContent = ''; // Text is hidden by CSS rule, but good practice
         });
      });
      
      function togglePasswordVisibility(inputId, button) {
         const input = document.getElementById(inputId);
         const icon = button.querySelector('i');
         
         if (input.type === 'password') {
            input.type = 'text';
            icon.className = 'fas fa-eye-slash';
         } else {
            input.type = 'password';
            icon.className = 'fas fa-eye';
         }
      }
   </script>
</body>
</html>